<div class="review-status">
  <% if @object.review_status.present? %>
  <h2>Review Status</h2>
  <div class="review-status-list content-block">
    <ul>
      <% @object.review_status.each do |review| %>
      <li><%= review %></li>
      <% end -%>
    </ul>
  </div>
  <% end %>
  <% @object.ingested.each do |ingest| -%>
    <% @document = ActiveFedora::Base.find(ingest) %>
      <%= form_for @object, :validate => true, :html => {:class => "ingest-review"}, :method => :post, :url => "/repos/#{@object.id}/review_status" do |f| %>
      <%= f.label :review_status, "Add a Review Status note for #{@document.identifier.first}" %>
      <%= f.text_area :review_status, :value => nil %>
      <%= f.submit "Add note" %>
    <% end -%>
</div>

<div class="metadata-only-preview content-block">
  <h2>Alphabetized metadata-only preview of <%= ingest %></h2>
  <% @document.attribute_names.sort.each do |a_name| -%>
    <% if @document.try(a_name).present? %>
    <strong><%= a_name.capitalize %></strong>
    <ul>
      <% Array[@document.try(a_name)].flatten(1).each do |value| %>
        <li><%= value %></li>
      <% end -%>
    </ul>
    <% end %>
  <% end -%>
<% end -%>
</div>


<div class="structural-metadata-preview">
  <% ActiveFedora::Base.where(:id => "#{@document.id}/members").each do |member| %>
    <% member.contained.each do |container| %>
      <% obj = ActiveFedora::Base.find(id: ActiveFedora::Base.find(ActiveFedora::Base.uri_to_id(container.id)).target_id).first %>

      <% obj.attribute_names.sort.each do |a_name| -%>
        <% if obj.try(a_name).present? %>
        <strong><%= a_name.capitalize %></strong>
        <ul>
          <% Array[obj.try(a_name)].flatten(1).each do |value| %>
            <li><%= value %></li>
          <% end -%>
        </ul>
        <% end %>
      <% end -%>


    <% end -%>
  <% end -%>
</div>
